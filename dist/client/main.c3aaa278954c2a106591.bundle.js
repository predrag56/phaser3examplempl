!function(t){function e(e){for(var i,r,c=e[0],a=e[1],u=e[2],l=0,f=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);for(h&&h(e);f.length;)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,c=1;c<n.length;c++){var a=n[c];0!==o[a]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={0:0},s=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="static/client";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=a;s.push([571,1]),n()}({1493:function(t,e){},1496:function(t,e,n){"use strict";n.r(e);n(572);var i,o=function(t){var e=window.innerWidth,n=window.innerHeight,i=Math.min(e/896,n/504),o=Math.min(e/i,1344),s=Math.min(n/i,756),r=1,c=function(t,e,n){return(t-e)/(n-e)};r=896/504<e/n?-c(o/s,896/504,1344/504)/(1/(1.15-1))+1.15:-c(o/s,896/504,896/756)/(1/(1.15-1))+1.15,t.scale.resize(o*r,s*r),t.canvas.style.width=o*i+"px",t.canvas.style.height=s*i+"px",t.canvas.style.marginTop=(n-s*i)/2+"px",t.canvas.style.marginLeft=(e-o*i)/2+"px"},s=n(570),r=n.n(s),c={DUDE:0,BOX:1,STAR:2,MUMMY:3},a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(){return t.call(this,{key:"PreloadScene"})||this}return a(e,t),e.prototype.preload=function(){this.load.setBaseURL("static/client"),this.load.image(c.BOX.toString(),"assets/box.png"),this.load.image(c.STAR.toString(),"assets/star.png"),this.load.image("bug","assets/bug.png"),this.load.image("starfield","assets/starfield.jpg"),this.load.image("controls","assets/controls.png"),this.load.spritesheet(c.DUDE.toString(),"assets/dude.png",{frameWidth:32,frameHeight:48}),this.load.spritesheet("fullscreen","assets/fullscreen.png",{frameWidth:64,frameHeight:64}),this.load.spritesheet(c.MUMMY.toString(),"assets/mummy37x45.png",{frameWidth:37,frameHeight:45})},e.prototype.create=function(){var t,e=this;(t=this).anims.create({key:"left",frames:t.anims.generateFrameNumbers(c.DUDE.toString(),{start:0,end:3}),frameRate:10,repeat:-1}),t.anims.create({key:"idle",frames:[{key:c.DUDE.toString(),frame:4}],frameRate:20}),t.anims.create({key:"right",frames:t.anims.generateFrameNumbers(c.DUDE.toString(),{start:5,end:8}),frameRate:10,repeat:-1}),function(t){t.anims.create({key:"walk",frames:t.anims.generateFrameNumbers(c.MUMMY.toString(),{}),frameRate:16,repeat:7})}(this);var n=location.origin+"/G",i=r.a.connect(n,{transports:["websocket"]});i.on("reconnect_attempt",(function(){i.io.opts.transports=["polling","websocket"]})),i.on("connect",(function(){console.log("You're connected to socket.io")})),i.on("clientId",(function(t){i.clientId=t,console.log("Your client id",t),e.scene.start("MenuScene",{socket:i})}))},e}(Phaser.Scene),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),l=function(t){function e(){return t.call(this,{key:"MenuScene"})||this}return h(e,t),e.prototype.init=function(t){var e=t.socket;this.socket=e},e.prototype.create=function(){var t=this,e={color:"#000000",align:"center",fontSize:52},n=[];n.push(this.add.text(0,0,"Choose which Level\nyou want to play",e).setOrigin(.5,0)),n.push(this.add.text(0,0,"Matter Physics",e).setOrigin(.5,0).setInteractive().on("pointerdown",(function(){t.scene.start("MainScene",{scene:"MatterScene",level:0,socket:t.socket})}))),n.push(this.add.text(0,0,"Arcade Physics (Level 1)",e).setOrigin(.5,0).setInteractive().on("pointerdown",(function(){t.scene.start("MainScene",{scene:"ArcadeScene",level:0,socket:t.socket})}))),n.push(this.add.text(0,0,"Arcade Physics (Level 2)",e).setOrigin(.5,0).setInteractive().on("pointerdown",(function(){t.scene.stop(),t.scene.start("MainScene",{scene:"ArcadeScene",level:1,socket:t.socket})}))),n.push(this.add.text(0,0,"Arcade Physics (Level 3)",e).setOrigin(.5,0).setInteractive().on("pointerdown",(function(){t.scene.stop(),t.scene.start("MainScene",{scene:"ArcadeScene",level:2,socket:t.socket})})));var i=function(){var e=t.cameras.main,i=e.centerX,o=e.centerY,s=[20,o-100,o-10,o+60,o+130];n.forEach((function(t,e){t.setPosition(i,s[e])}))};this.scale.on("resize",(function(e,n,o,s){t.scene.isActive()&&(t.cameras.resize(e.width,e.height),i())})),i(),o(this.game)},e}(Phaser.Scene),f=[{y:230,fontSize:28,type:"server_running_time"},{y:260,fontSize:28,type:"the_room_id"},{y:290,fontSize:28,type:"show_connected_users"},{y:320,fontSize:28,type:"show_latency"},{y:350,fontSize:28,type:"show_fps"}],p=function(){function t(t){var e=this;this.scene=t,this.textObjects={},this.hidden=!1,f.forEach((function(n){var i=t.add.text(t.cameras.main.width/2,n.y,"",{color:"#ffffff",fontSize:n.fontSize}).setOrigin(.5).setResolution(window.devicePixelRatio).setScrollFactor(0).setDepth(100);e.textObjects[n.type]=i})),this.makeBug(),this.resize(),this.toggleHidden(),this.scene.events.on("update",this.update,this)}return t.prototype.update=function(){this.hidden||this.setFps(this.scene.game.loop.actualFps)},t.prototype.makeBug=function(){var t=this;this.bug=this.scene.add.image(0,0,"bug").setOrigin(0).setScrollFactor(0).setDepth(100),this.bug.setInteractive().on("pointerdown",(function(){t.toggleHidden()}))},t.prototype.toggleHidden=function(){for(var t in this.hidden=!this.hidden,this.textObjects)this.textObjects[t].setAlpha(this.hidden?0:1)},t.prototype.resize=function(){var t=this;f.forEach((function(e){t.textObjects[e.type].setPosition(t.scene.cameras.main.width/2,e.y)})),this.bug&&this.bug.setPosition(16,16)},t.prototype.setConnectCounter=function(t){this.textObjects.show_connected_users.setText("Connected users: "+t+"/4")},t.prototype.setRoomId=function(t){this.textObjects.the_room_id.setText("RoomId "+t)},t.prototype.setTime=function(t){this.textObjects.server_running_time.setText("Server is running since "+new Date(t).toUTCString())},t.prototype.setFps=function(t){this.textObjects.show_fps.setText("fps: "+Math.round(t))},t.prototype.setLatency=function(t){if(!isNaN(t.current)){(isNaN(t.high)||t.current>t.high)&&(t.high=t.current),(isNaN(t.low)||t.current<t.low)&&(t.low=t.current);var e=t.history.reduce((function(t,e){return e+t}))/t.history.length;this.textObjects.show_latency.setText("Latency "+t.current+"ms (avg "+Math.round(e)+"ms / low "+t.low+"ms / high "+t.high+"ms)")}},t}(),d=function(){function t(t,e){this.scene=t,this.socket=e,this.none=!0,this.prevNone=!0,this.left=!1,this.right=!1,this.up=!1,this.cursors=t.input.keyboard.createCursorKeys(),this.scene.events.on("update",this.update,this)}return t.prototype.cursorsDown=function(){return{left:this.left,right:this.right,up:this.up,none:this.none}},t.prototype.update=function(){if(this.cursors.left&&this.cursors.right&&this.cursors.up){if(this.none=!(this.cursors.left.isDown||this.cursors.right.isDown||this.cursors.up.isDown),!this.none||this.none!==this.prevNone){this.left=!1,this.right=!1,this.up=!1,this.cursors.left.isDown?this.left=!0:this.cursors.right.isDown&&(this.right=!0),this.cursors.up.isDown&&(this.up=!0);var t=0;this.left&&(t+=1),this.right&&(t+=2),this.up&&(t+=4),this.none&&(t+=8),this.socket.emit("U",t)}this.prevNone=this.none}},t}(),y=function(t){var e=t.add.image(0,0,"fullscreen",0).setOrigin(1,0).setInteractive().setScrollFactor(0).setDepth(100);return e.on("pointerup",(function(){t.scale.isFullscreen?(e.setFrame(0),t.scale.stopFullscreen()):(e.setFrame(1),t.scale.startFullscreen())})),e},g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),m=function(){function t(t,e){var n=this;this.scene=t,this.socket=e,this.left=!1,this.right=!1,this.up=!1,this.controls=[],this.none=!0,this.prevNone=!0,t.input.addPointer();var i=function(t,e){if(t.btn)switch(t.btn){case"left":n.left=e;break;case"right":n.right=e;break;case"up":n.up=e}};t.input.on("gameobjectdown",(function(t,e){return i(e,!0)})),t.input.on("gameobjectup",(function(t,e){return i(e,!1)}));var o=new v(t,0,0,"left").setRotation(-.5*Math.PI),s=new v(t,0,0,"right").setRotation(.5*Math.PI),r=new v(t,0,0,"up");this.controls.push(o,s,r),this.resize(),this.scene.events.on("update",this.update,this)}return t.prototype.controlsDown=function(){return{left:this.left,right:this.right,up:this.up,none:this.none}},t.prototype.resize=function(){var t=this.scene.cameras.main.width-10-96,e=this.scene.cameras.main.height-10-96,n=[{x:106,y:e},{x:310,y:e},{x:t,y:e}];this.controls.forEach((function(t,e){t.setPosition(n[e].x,n[e].y),t.setScale(1)}))},t.prototype.update=function(){if(this.none=!(this.left||this.right||this.up),!this.none||this.none!==this.prevNone){var t=0;this.left&&(t+=1),this.right&&(t+=2),this.up&&(t+=4),this.none&&(t+=8),this.socket.emit("U",t)}this.prevNone=this.none},t}(),v=function(t){function e(e,n,i,o){var s=t.call(this,e,n,i,"controls")||this;return s.btn=o,e.add.existing(s),s.setInteractive().setScrollFactor(0).setAlpha(.5).setDepth(2),e.sys.game.device.input.touch||s.setAlpha(0),s}return g(e,t),e}(Phaser.GameObjects.Image),b=function(){return(b=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},w=function(){function t(){}return t.prepareFromPhaserGroup=function(e,n){e.children.iterate((function(e){t.prepareFromPhaserSprite(e,n)}))},t.prepareFromPhaserSprite=function(e,n){var i=b(b({},e),this.getXY(e));n.push(t.cleanObjectToSync(i))},t.prepareFromMatterGameObject=function(e,n){e.forEach((function(e){n.push(t.cleanObjectToSync(e))}))},t.getXY=function(t){return{x:t.body.position.x+t.body.width/2,y:t.body.position.y+t.body.height/2}},t.mergeObjectToSync=function(t,e){var n,i=!1;return Object.keys(e).forEach((function(n){n===t.id&&(e[t.id]=b(b({},e[t.id]),t),i=!0)})),i||(e=b(b({},e),((n={})[t.id]=t,n))),e},t.cleanObjectToSync=function(t){var e=function(t,e){var i;null!==e&&(n=b(b({},n),((i={})[t]=e,i)))},n={};return e("id",t.id||t.body.id),e("x",t.x||t.body.position.x||null),e("y",t.y||t.body.position.y||null),e("angle","undefined"!==t.angle?t.angle:null),e("dead","undefined"!==t.dead?t.dead:null),e("skin","undefined"!==t.skin?t.skin:null),e("animation",t.animation||null),e("direction",t.direction||null),e("scale",t.scale&&1!==t.scale?t.scale:null),e("tint",t.tint?t.tint:null),e("clientId",t.clientId||null),e("category",t.category||null),n},Object.defineProperty(t,"keys",{get:function(){return["id","x","y","angle","dead","skin","animation","direction","scale","tint","clientId","category"]},enumerable:!1,configurable:!0}),t.decode=function(e){var n=t.keys,i=[],o={};return e.split(",").forEach((function(t,e){var s=n[e%n.length];"id"===s?o[s]=parseInt(t,36).toString():["skin","scale"].includes(s)?o[s]=""!==t?parseInt(t):null:["x","y","angle","clientId"].includes(s)?o[s]=""!==t?parseInt(t,36):null:["dead"].includes(s)?o[s]="0"!==t&&("1"===t||null):o[s]=""!==t?t:null,e%n.length==n.length-1&&(i.push(b({},o)),o={})})),i},t.encode=function(e){var n=t.keys,i="";return e.forEach((function(t){n.forEach((function(e){if(void 0!==t[e]){var n=t[e];"boolean"==typeof t[e]?n=!1===t[e]?0:1:["id","x","y","angle","clientId"].includes(e)&&(n=(n=+(n=+n).toFixed(0)).toString(36)),i+=n+","}else i+=","}))})),i.slice(0,-1)},t}(),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),O=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var s=arguments[e],r=0,c=s.length;r<c;r++,o++)i[o]=s[r];return i},_=function(t){function e(){var e=t.call(this,{key:"MainScene"})||this;return e.objects={},e.sync={initialState:!1,objects:[]},e.latency={current:NaN,high:NaN,low:NaN,ping:NaN,id:"",canSend:!0,history:[]},e.level=0,e}return S(e,t),e.prototype.init=function(t){var e=t.scene,n=t.level,i=void 0===n?0:n,o=t.socket;this.level=i,this.socket=o,this.socket.emit("joinRoom",{scene:e,level:i})},e.prototype.create=function(){var t=this,e=this.socket,n=this.add.text(0,0,"Level "+(this.level+1),{color:"#ffffff",fontSize:42}).setOrigin(.5,0).setDepth(100).setScrollFactor(0),i=this.add.tileSprite(j.x,j.y,j.width,j.height,"starfield").setOrigin(0);this.cursors=new d(this,e),this.controls=new m(this,e);var s=new p(this),r=y(this);this.cameras.main.setBounds(j.x,j.y,j.width,j.height),e.on("getPong",(function(e){t.latency.id===e&&(t.latency.canSend=!0,t.latency.current=(new Date).getTime()-t.latency.ping,t.latency.history.length>=200&&t.latency.history.shift(),t.latency.history.push(t.latency.current),s.setLatency(t.latency))})),this.time.addEvent({delay:250,loop:!0,callback:function(){t.latency.canSend&&(s.hidden||(t.latency.ping=(new Date).getTime(),t.latency.id=Phaser.Math.RND.uuid(),t.latency.canSend=!1,e.emit("sendPing",t.latency.id)))}}),e.on("changingRoom",(function(i){console.log("You are changing room"),Object.keys(t.objects).forEach((function(e){t.objects[e].sprite.destroy(),delete t.objects[e]})),e.emit("getInitialState"),t.level=0|i.level,n.setText("Level "+(t.level+1))})),e.on("S",(function(n){n.connectCounter&&s.setConnectCounter(n.connectCounter),n.time&&s.setTime(n.time),n.roomId&&s.setRoomId(n.roomId),n.O&&(n.O=w.decode(n.O),t.sync.objects=O(t.sync.objects,n.O),t.sync.objects.forEach((function(n){if(t.objects[n.id]&&n.skin===c.DUDE&&n.clientId&&+n.clientId==+e.clientId&&t.cameras.main.setScroll(n.x-t.cameras.main.width/2,n.y-t.cameras.main.height/2),!t.objects[n.id]){var i=t.add.sprite(n.x,n.y,n.skin.toString()).setOrigin(.5).setRotation(n.angle||0);t.objects[n.id]={sprite:i}}var o=t.objects[n.id].sprite;n.scale&&o.setScale(n.scale),n.tint&&o.setTint(n.tint),o.setVisible(!n.dead)})))})),e.emit("getInitialState"),this.game.events.on("focus",(function(){return e.emit("getInitialState")})),this.input.on("pointerdown",(function(t){console.log(t.worldX,t.worldY)}));this.scale.on("resize",(function(e,o,c,a){t.cameras.resize(e.width,e.height),i.setScale(Math.max(t.cameras.main.height/i.height,1)),s.resize(),t.controls&&t.controls.resize(),r.setPosition(t.cameras.main.width-16,16),t.cameras.main.setScroll(t.cameras.main.worldView.x,j.height),n.setPosition(t.cameras.main.width/2,20)})),o(this.game)},e.prototype.update=function(t,e){var n=this;this.sync.objects.length>0&&this.sync.objects.forEach((function(t){if(n.objects[t.id]){var e=n.objects[t.id].sprite;null!==t.dead&&e.setVisible(!t.dead),null!==t.x&&(e.x=t.x),null!==t.y&&(e.y=t.y),null!==t.angle&&void 0!==t.angle&&(e.angle=t.angle),null!==t.skin&&(t.skin===c.MUMMY&&null!==t.direction&&function(t,e){t.anims.isPlaying||t.anims.play("walk");var n="left"===e;t.setFlipX(n)}(e,t.direction),t.skin===c.DUDE&&null!==t.animation&&function(t,e){void 0===e&&(e="idle"),t.anims.isPlaying?t.anims.isPlaying&&t.anims.getCurrentKey()!==e&&t.play(e):t.play(e)}(e,t.animation))}})),this.sync.objects=[]},e}(Phaser.Scene),j={x:0,y:0,width:2560,height:864},x={type:Phaser.WEBGL,backgroundColor:"#ffffff",scale:{parent:"phaser-game",mode:Phaser.Scale.NONE,width:1280,height:720},scene:[u,l,_],physics:{default:"matter",matter:{gravity:{y:.8},debug:!1,debugBodyColor:16711935}}},k=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),P=function(t){function e(){return t.call(this,x)||this}return k(e,t),e}(Phaser.Game),M=function(t){var e=function(){[50,100,200,500,1e3,2e3,5e3].forEach((function(e){window.setTimeout((function(){t()}),e)}))};["webkit","moz","ms",""].forEach((function(t){document.addEventListener(t+"fullscreenchange",e,!1)})),document.addEventListener("MSFullscreenChange",e,!1)};window.addEventListener("load",(function(){var t=new P;window.addEventListener("resize",(function(){o(t)})),M((function(){return o(t)})),o(t)}))},571:function(t,e,n){t.exports=n(1496)}});